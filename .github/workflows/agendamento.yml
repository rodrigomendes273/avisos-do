name: Alerta Diário Oficial

# Define quando o workflow vai rodar
on:
  schedule:
    - cron: '48 2 * * *'  # Todo dia às 23:21 UTC
  workflow_dispatch:      # Permite rodar manualmente no GitHub

jobs:
  run-script:
    runs-on: ubuntu-latest  # Ambiente Linux mais recente

    steps:
      # 1️⃣ Pega o código do repositório
      - name: Checkout do repositório
        uses: actions/checkout@v3

      # 2️⃣ Configura o Python
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      # 3️⃣ Instala dependências necessárias
      - name: Instalar dependências
        run: |
          python -m pip install --upgrade pip
          pip install requests PyMuPDF

      # 4️⃣ Executa o script
      - name: Executar script
        env:
          EMAIL_REMETENTE: ${{ secrets.EMAIL_REMETENTE }}
          EMAIL_SENHA: ${{ secrets.EMAIL_SENHA }}
          EMAIL_DESTINO: ${{ secrets.EMAIL_DESTINO }}
        run: |
          python script.py
